import sys 
sys.path.append('./python')

import TransFTrain as train
import TransFTrain.nn as nn

import unittest
import numpy as np

class TestTransformationsRandomFlipHorizontal(unittest.TestCase): 
    def test_flip_horizontal(self):
        tform = train.data.RandomFlipHorizontal()
        np.random.seed(0)
        a = np.array([[[0.6788795301189603, 0.7206326547259168, 0.5820197920751071, 0.5373732294490107, 0.7586156243223572], [0.10590760718779213, 0.4736004193466574, 0.18633234332675996, 0.7369181771289581, 0.21655035442437187]], [[0.13521817340545206, 0.3241410077932141, 0.14967486718368317, 0.22232138825158765, 0.38648898112586194], [0.9025984755294046, 0.4499499899112276, 0.6130634578841324, 0.9023485831739843, 0.09928035035897387]], [[0.9698090677467488, 0.6531400357979377, 0.17090958513604515, 0.358152166969525, 0.7506861412184562], [0.6078306687154678, 0.3250472290083525, 0.038425426472734725, 0.634274057957335, 0.9589492686245203]], [[0.6527903170054908, 0.6350588736035638, 0.9952995676778876, 0.5818503294385343, 0.4143685882263688], [0.4746975022884129, 0.6235101011318682, 0.33800761483889175, 0.6747523222590207, 0.3172017420692961]], [[0.778345482025909, 0.9495710534507421, 0.6625268669500443, 0.013571635612109834, 0.6228460955466695], [0.6736596308357894, 0.9719450024996658, 0.878193471347177, 0.5096243767199001, 0.05571469370160631]], [[0.4511592145209281, 0.019987665408758737, 0.44171092124884537, 0.9795867288127285, 0.3594444639693215], [0.4808935308361628, 0.6886611828057704, 0.8804758892525955, 0.9182354663621447, 0.21682213762754288]]])
        b = np.array([[[0.6788795301189603, 0.7206326547259168, 0.5820197920751071, 0.5373732294490107, 0.7586156243223572], [0.10590760718779213, 0.4736004193466574, 0.18633234332675996, 0.7369181771289581, 0.21655035442437187]], [[0.13521817340545206, 0.3241410077932141, 0.14967486718368317, 0.22232138825158765, 0.38648898112586194], [0.9025984755294046, 0.4499499899112276, 0.6130634578841324, 0.9023485831739843, 0.09928035035897387]], [[0.9698090677467488, 0.6531400357979377, 0.17090958513604515, 0.358152166969525, 0.7506861412184562], [0.6078306687154678, 0.3250472290083525, 0.038425426472734725, 0.634274057957335, 0.9589492686245203]], [[0.6527903170054908, 0.6350588736035638, 0.9952995676778876, 0.5818503294385343, 0.4143685882263688], [0.4746975022884129, 0.6235101011318682, 0.33800761483889175, 0.6747523222590207, 0.3172017420692961]], [[0.778345482025909, 0.9495710534507421, 0.6625268669500443, 0.013571635612109834, 0.6228460955466695], [0.6736596308357894, 0.9719450024996658, 0.878193471347177, 0.5096243767199001, 0.05571469370160631]], [[0.4511592145209281, 0.019987665408758737, 0.44171092124884537, 0.9795867288127285, 0.3594444639693215], [0.4808935308361628, 0.6886611828057704, 0.8804758892525955, 0.9182354663621447, 0.21682213762754288]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.5651888666048753, 0.865102561305385, 0.5089689606670145], [0.9167229540194608, 0.9211576102371998, 0.08311249263060239], [0.27771856128103245, 0.009356704856532616, 0.842342079667731], [0.6471741401875555, 0.8413861191973544, 0.26473016428344964], [0.39782075275862905, 0.5528214798875715, 0.16494046024188413]], [[0.36980809274834003, 0.14644176272911225, 0.5696184059233067], [0.7037372792899163, 0.28847643704852866, 0.43328806198204406], [0.7561066938650409, 0.3960982754233623, 0.896038387509077], [0.6389210762313129, 0.8915544372256771, 0.6800555694634123], [0.44919773821837206, 0.978570928420717, 0.1162019096123944]], [[0.7670237035587267, 0.4118201389648447, 0.675439081200236], [0.24979627565497808, 0.31321833194595095, 0.965416220519927], [0.5884650850687494, 0.6596684120694128, 0.5332062539166482], [0.23053302350632987, 0.39486929345022914, 0.6188085645913571], [0.474867515408942, 0.47013218925576516, 0.7160745312286432]], [[0.2879910043632805, 0.38346222503494787, 0.7491698371527247], [0.878452190276042, 0.10286335869343821, 0.0923738894608982], [0.3540466620838102, 0.5518162591332588, 0.033625093498832026], [0.9689617652602737, 0.3209972413734975, 0.22126268518378278], [0.1412639049258967, 0.09725992706317388, 0.9840422413641464]], [[0.2603409275874047, 0.5370225213757797, 0.4479261718707299], [0.09956908911081108, 0.35231166120053303, 0.46924917399024213], [0.8411401297855995, 0.9046477442095134, 0.03755938382814028], [0.5083154485788909, 0.16684751304849965, 0.7790510196090357], [0.8649332956024927, 0.41139672375545455, 0.13997258549320168]]])
        b = np.array([[[0.5651888666048753, 0.865102561305385, 0.5089689606670145], [0.9167229540194608, 0.9211576102371998, 0.08311249263060239], [0.27771856128103245, 0.009356704856532616, 0.842342079667731], [0.6471741401875555, 0.8413861191973544, 0.26473016428344964], [0.39782075275862905, 0.5528214798875715, 0.16494046024188413]], [[0.36980809274834003, 0.14644176272911225, 0.5696184059233067], [0.7037372792899163, 0.28847643704852866, 0.43328806198204406], [0.7561066938650409, 0.3960982754233623, 0.896038387509077], [0.6389210762313129, 0.8915544372256771, 0.6800555694634123], [0.44919773821837206, 0.978570928420717, 0.1162019096123944]], [[0.7670237035587267, 0.4118201389648447, 0.675439081200236], [0.24979627565497808, 0.31321833194595095, 0.965416220519927], [0.5884650850687494, 0.6596684120694128, 0.5332062539166482], [0.23053302350632987, 0.39486929345022914, 0.6188085645913571], [0.474867515408942, 0.47013218925576516, 0.7160745312286432]], [[0.2879910043632805, 0.38346222503494787, 0.7491698371527247], [0.878452190276042, 0.10286335869343821, 0.0923738894608982], [0.3540466620838102, 0.5518162591332588, 0.033625093498832026], [0.9689617652602737, 0.3209972413734975, 0.22126268518378278], [0.1412639049258967, 0.09725992706317388, 0.9840422413641464]], [[0.2603409275874047, 0.5370225213757797, 0.4479261718707299], [0.09956908911081108, 0.35231166120053303, 0.46924917399024213], [0.8411401297855995, 0.9046477442095134, 0.03755938382814028], [0.5083154485788909, 0.16684751304849965, 0.7790510196090357], [0.8649332956024927, 0.41139672375545455, 0.13997258549320168]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.03322238526617727, 0.9825749598251936, 0.3732907507832548, 0.42007536979061066, 0.050588115054237215, 0.36549610626341034], [0.016627973733867263, 0.23074233540679567, 0.7649116989968572, 0.9441235194354546, 0.7499992487701004, 0.3394038194495186], [0.4895489368910937, 0.3389851167797783, 0.1794902609178557, 0.17098659868313149, 0.46345097738448293, 0.8745729576449965], [0.9441197509175635, 0.608252865854013, 0.5966554062950531, 0.7836442453018885, 0.5000262977293014, 0.0503700567575438]], [[0.6990980747185112, 0.9923963988886326, 0.26726253788147825, 0.6790906156274139, 0.8642814426862446, 0.7508442456284316], [0.9644897677894309, 0.5542424350844403, 0.2123904988903086, 0.22244322438681874, 0.21874937373677183, 0.569573534574738], [0.4521090350334257, 0.9702366830961006, 0.6805446911927795, 0.08529556585870057, 0.056418332713966235, 0.48783770435896423], [0.8810045622016749, 0.9764043865930425, 0.6176579160958802, 0.5424987750103974, 0.8546135803107144, 0.7438345453097878]], [[0.4785963256187501, 0.6770815740270854, 0.6070450611164516, 0.7146969362373571, 0.46949718309117094, 0.45601462321786723], [0.9064180870601711, 0.1372204200971946, 0.22921932308657944, 0.8815853992105808, 0.9044249756892315, 0.6457845985018992], [0.32468297206646535, 0.5197111936582762, 5.535686500857118e-05, 0.3118602206821891, 0.42545153795217594, 0.8853376596095855], [0.6798794564067695, 0.456129772122862, 0.48340861659875267, 0.7887394275320365, 0.22944183447104538, 0.8802976031150046]], [[0.3136923925080297, 0.9574508556589537, 0.4717515708928012, 0.7115838170608139, 0.15369430500779646, 0.7304421765667943], [0.6462644373146849, 0.21488073675057817, 0.1864582194893385, 0.8075802688587874, 0.7470794701392341, 0.6748473459286921], [0.276893750817091, 0.17490887430950752, 0.704474258393494, 0.4631501999901332, 0.8404285325354325, 0.20486576218044572], [0.1649588680867573, 0.124833057490086, 0.7220806624027486, 0.030452964941600325, 0.7469942401995034, 0.09259616511851354]], [[0.21745049270557182, 0.7492544170632397, 0.7316937564646905, 0.04561463715088643, 0.20915702948084114, 0.2869150433006046], [0.6772633053384269, 0.06303828966937675, 0.5556492427701452, 0.009240073486540767, 0.8330380975093908, 0.984329434348122], [0.7034947841347021, 0.18163120049204873, 0.5123934632959037, 0.5804471371881301, 0.7875421559550259, 0.6064754600685757], [0.2184028548119228, 0.4551688151933373, 0.8788697417774708, 0.4922682415051587, 0.7155611574590398, 0.48615956031119767]]])
        b = np.array([[[0.03322238526617727, 0.9825749598251936, 0.3732907507832548, 0.42007536979061066, 0.050588115054237215, 0.36549610626341034], [0.016627973733867263, 0.23074233540679567, 0.7649116989968572, 0.9441235194354546, 0.7499992487701004, 0.3394038194495186], [0.4895489368910937, 0.3389851167797783, 0.1794902609178557, 0.17098659868313149, 0.46345097738448293, 0.8745729576449965], [0.9441197509175635, 0.608252865854013, 0.5966554062950531, 0.7836442453018885, 0.5000262977293014, 0.0503700567575438]], [[0.6990980747185112, 0.9923963988886326, 0.26726253788147825, 0.6790906156274139, 0.8642814426862446, 0.7508442456284316], [0.9644897677894309, 0.5542424350844403, 0.2123904988903086, 0.22244322438681874, 0.21874937373677183, 0.569573534574738], [0.4521090350334257, 0.9702366830961006, 0.6805446911927795, 0.08529556585870057, 0.056418332713966235, 0.48783770435896423], [0.8810045622016749, 0.9764043865930425, 0.6176579160958802, 0.5424987750103974, 0.8546135803107144, 0.7438345453097878]], [[0.4785963256187501, 0.6770815740270854, 0.6070450611164516, 0.7146969362373571, 0.46949718309117094, 0.45601462321786723], [0.9064180870601711, 0.1372204200971946, 0.22921932308657944, 0.8815853992105808, 0.9044249756892315, 0.6457845985018992], [0.32468297206646535, 0.5197111936582762, 5.535686500857118e-05, 0.3118602206821891, 0.42545153795217594, 0.8853376596095855], [0.6798794564067695, 0.456129772122862, 0.48340861659875267, 0.7887394275320365, 0.22944183447104538, 0.8802976031150046]], [[0.3136923925080297, 0.9574508556589537, 0.4717515708928012, 0.7115838170608139, 0.15369430500779646, 0.7304421765667943], [0.6462644373146849, 0.21488073675057817, 0.1864582194893385, 0.8075802688587874, 0.7470794701392341, 0.6748473459286921], [0.276893750817091, 0.17490887430950752, 0.704474258393494, 0.4631501999901332, 0.8404285325354325, 0.20486576218044572], [0.1649588680867573, 0.124833057490086, 0.7220806624027486, 0.030452964941600325, 0.7469942401995034, 0.09259616511851354]], [[0.21745049270557182, 0.7492544170632397, 0.7316937564646905, 0.04561463715088643, 0.20915702948084114, 0.2869150433006046], [0.6772633053384269, 0.06303828966937675, 0.5556492427701452, 0.009240073486540767, 0.8330380975093908, 0.984329434348122], [0.7034947841347021, 0.18163120049204873, 0.5123934632959037, 0.5804471371881301, 0.7875421559550259, 0.6064754600685757], [0.2184028548119228, 0.4551688151933373, 0.8788697417774708, 0.4922682415051587, 0.7155611574590398, 0.48615956031119767]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.708548150020003, 0.49814022550747006, 0.8445500794719424, 0.1943422229429832, 0.7733260096105699, 0.9742586638572328], [0.862309777350283, 0.7804266511040134, 0.9850322788832359, 0.753569606672163, 0.004048106368426341, 0.2694794339581177]], [[0.41049213809445695, 0.42822383211640813, 0.2978418185550563, 0.40113234155862765, 0.12065699118611972, 0.9806996740240193], [0.40612049298131103, 0.5692107600936255, 0.3436055031480987, 0.7888727777194641, 0.4113724140379379, 0.3592714170600857]]])
        b = np.array([[[0.708548150020003, 0.49814022550747006, 0.8445500794719424, 0.1943422229429832, 0.7733260096105699, 0.9742586638572328], [0.862309777350283, 0.7804266511040134, 0.9850322788832359, 0.753569606672163, 0.004048106368426341, 0.2694794339581177]], [[0.41049213809445695, 0.42822383211640813, 0.2978418185550563, 0.40113234155862765, 0.12065699118611972, 0.9806996740240193], [0.40612049298131103, 0.5692107600936255, 0.3436055031480987, 0.7888727777194641, 0.4113724140379379, 0.3592714170600857]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.3994989103160902, 0.30183087592751656], [0.7752197774666111, 0.9262129301763149], [0.3253103051589964, 0.9528706723868426]], [[0.013948395933415347, 0.5334656817509289], [0.3045820306759077, 0.882859998043791], [0.25062272019388543, 0.6774118294719442]], [[0.8104240912598908, 0.4321480499248166], [0.7521345209879338, 0.8296022479277191], [0.37903377210381817, 0.09654960982745808]], [[0.25613957741471227, 0.5919351581884497], [0.47647720054983067, 0.4879345689871769], [0.4585145522366506, 0.5245926207548479]]])
        b = np.array([[[0.3253103051589964, 0.9528706723868426], [0.7752197774666111, 0.9262129301763149], [0.3994989103160902, 0.30183087592751656]], [[0.25062272019388543, 0.6774118294719442], [0.3045820306759077, 0.882859998043791], [0.013948395933415347, 0.5334656817509289]], [[0.37903377210381817, 0.09654960982745808], [0.7521345209879338, 0.8296022479277191], [0.8104240912598908, 0.4321480499248166]], [[0.4585145522366506, 0.5245926207548479], [0.47647720054983067, 0.4879345689871769], [0.25613957741471227, 0.5919351581884497]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.44201531779487013, 0.85263492378234], [0.43343897446935586, 0.8268703682806414], [0.5093420653681867, 0.08637698037064123]], [[0.660039862222949, 0.20659460707526944], [0.8472753225073781, 0.6813591290967357], [0.17836734931031717, 0.06985901733934607]], [[0.009688170796795847, 0.8920496580813289], [0.1334652095813622, 0.7791919742513885], [0.9251634258375487, 0.7151787489637426]]])
        b = np.array([[[0.44201531779487013, 0.85263492378234], [0.43343897446935586, 0.8268703682806414], [0.5093420653681867, 0.08637698037064123]], [[0.660039862222949, 0.20659460707526944], [0.8472753225073781, 0.6813591290967357], [0.17836734931031717, 0.06985901733934607]], [[0.009688170796795847, 0.8920496580813289], [0.1334652095813622, 0.7791919742513885], [0.9251634258375487, 0.7151787489637426]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.4908186128508779, 0.4694983029278751, 0.8827092893929042, 0.4884100599403899, 0.4145674851494531], [0.17411195222713227, 0.475289441908616, 0.7836479651212873, 0.5564294271917406, 0.15986708206070577], [0.14382936568105598, 0.649463029783935, 0.5392235974137527, 0.32568476641681543, 0.14701389488880123], [0.1598700671429253, 0.12941233742225133, 0.5789223875388946, 0.09226017040693324, 0.9105447223934636], [0.08297174765619597, 0.8003784621072384, 0.8771309658812383, 0.09345945644411735, 0.4263058803232388], [0.47322067394571043, 0.5801971057632594, 0.7162441742180187, 0.027068984777190108, 0.7313973399998267]], [[0.7669635054509254, 0.009766435596283318, 0.30828616737698467, 0.23286547108097988, 0.5034274279399525], [0.9537213806638318, 0.5578113008828718, 0.09746868872548986, 0.6216784907560882, 0.86302261666035], [0.1576322757366576, 0.9924295232856558, 0.08500106751482528, 0.09445791415049454, 0.6336078897001911], [0.9492974733018349, 0.9367464737894553, 0.4473782946071331, 0.7276963431316488, 0.7422379779316829], [0.30698605596261264, 0.11977134909755616, 0.4438786756746984, 0.39177431923395767, 0.5318491770716929], [0.8453576818202398, 0.5362745443678752, 0.6802701510460296, 0.609177581558388, 0.09847800336397083]], [[0.09202758561195723, 0.055965828349447855, 0.08653249019938802, 0.23717329363871142, 0.8395129668196633], [0.5223705322713111, 0.5130748631715455, 0.6498319735234533, 0.5445908773835076, 0.03246529565126377], [0.5801517162709772, 0.7710890481699647, 0.3762265742721872, 0.49102474090072723, 0.9816396804040689], [0.24465141426217707, 0.3743231966372207, 0.04565964198897843, 0.3100676399689497, 0.8315193998721372], [0.807022835987101, 0.6400241552994383, 0.3681024019815341, 0.3127532957735243, 0.8018361500531322], [0.07044718594415944, 0.6835729603655977, 0.38072924499260763, 0.6339309563179247, 0.9268790894546248]]])
        b = np.array([[[0.47322067394571043, 0.5801971057632594, 0.7162441742180187, 0.027068984777190108, 0.7313973399998267], [0.08297174765619597, 0.8003784621072384, 0.8771309658812383, 0.09345945644411735, 0.4263058803232388], [0.1598700671429253, 0.12941233742225133, 0.5789223875388946, 0.09226017040693324, 0.9105447223934636], [0.14382936568105598, 0.649463029783935, 0.5392235974137527, 0.32568476641681543, 0.14701389488880123], [0.17411195222713227, 0.475289441908616, 0.7836479651212873, 0.5564294271917406, 0.15986708206070577], [0.4908186128508779, 0.4694983029278751, 0.8827092893929042, 0.4884100599403899, 0.4145674851494531]], [[0.8453576818202398, 0.5362745443678752, 0.6802701510460296, 0.609177581558388, 0.09847800336397083], [0.30698605596261264, 0.11977134909755616, 0.4438786756746984, 0.39177431923395767, 0.5318491770716929], [0.9492974733018349, 0.9367464737894553, 0.4473782946071331, 0.7276963431316488, 0.7422379779316829], [0.1576322757366576, 0.9924295232856558, 0.08500106751482528, 0.09445791415049454, 0.6336078897001911], [0.9537213806638318, 0.5578113008828718, 0.09746868872548986, 0.6216784907560882, 0.86302261666035], [0.7669635054509254, 0.009766435596283318, 0.30828616737698467, 0.23286547108097988, 0.5034274279399525]], [[0.07044718594415944, 0.6835729603655977, 0.38072924499260763, 0.6339309563179247, 0.9268790894546248], [0.807022835987101, 0.6400241552994383, 0.3681024019815341, 0.3127532957735243, 0.8018361500531322], [0.24465141426217707, 0.3743231966372207, 0.04565964198897843, 0.3100676399689497, 0.8315193998721372], [0.5801517162709772, 0.7710890481699647, 0.3762265742721872, 0.49102474090072723, 0.9816396804040689], [0.5223705322713111, 0.5130748631715455, 0.6498319735234533, 0.5445908773835076, 0.03246529565126377], [0.09202758561195723, 0.055965828349447855, 0.08653249019938802, 0.23717329363871142, 0.8395129668196633]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.8539401175386383, 0.49767797853565066], [0.42783437883147235, 0.822559451360812], [0.7382265807305043, 0.44714384049583633], [0.9689030410994359, 0.3631612578404464], [0.397533491596634, 0.738682659213446]], [[0.4490834277012896, 0.9372843639177566], [0.25723348547139335, 0.3817598072362818], [0.6971416168283547, 0.8970701046031435], [0.12105987960108544, 0.24154568649396324], [0.2282636099003713, 0.4895093288343594]]])
        b = np.array([[[0.8539401175386383, 0.49767797853565066], [0.42783437883147235, 0.822559451360812], [0.7382265807305043, 0.44714384049583633], [0.9689030410994359, 0.3631612578404464], [0.397533491596634, 0.738682659213446]], [[0.4490834277012896, 0.9372843639177566], [0.25723348547139335, 0.3817598072362818], [0.6971416168283547, 0.8970701046031435], [0.12105987960108544, 0.24154568649396324], [0.2282636099003713, 0.4895093288343594]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.8915226774917562, 0.3581074751151223], [0.38523741854992766, 0.9167270193301819], [0.11381664038986117, 0.6311255415710575], [0.13281499876869385, 0.3742445809714211], [0.3244048636316378, 0.6801155376270952]], [[0.7955347461391471, 0.5039336118794355], [0.2962423883711427, 0.885962269002118], [0.35187056092725555, 0.7383903376936126], [0.5553612630261748, 0.20151771332321833], [0.5485190962798103, 0.519642829449547]], [[0.34878266417059944, 0.0246199570564557], [0.14882930344317524, 0.13185203816295255], [0.7079174626754349, 0.7090721135651303], [0.6117484144329579, 0.671907016279956], [0.4475158707610247, 0.6960771689660051]], [[0.37832614484517124, 0.10003204928940568], [0.9602567843749067, 0.0724344474657973], [0.019300606451071012, 0.9795732518644896], [0.14847808772497184, 0.25870232207150123], [0.21552881156454484, 0.5799123983985056]]])
        b = np.array([[[0.8915226774917562, 0.3581074751151223], [0.38523741854992766, 0.9167270193301819], [0.11381664038986117, 0.6311255415710575], [0.13281499876869385, 0.3742445809714211], [0.3244048636316378, 0.6801155376270952]], [[0.7955347461391471, 0.5039336118794355], [0.2962423883711427, 0.885962269002118], [0.35187056092725555, 0.7383903376936126], [0.5553612630261748, 0.20151771332321833], [0.5485190962798103, 0.519642829449547]], [[0.34878266417059944, 0.0246199570564557], [0.14882930344317524, 0.13185203816295255], [0.7079174626754349, 0.7090721135651303], [0.6117484144329579, 0.671907016279956], [0.4475158707610247, 0.6960771689660051]], [[0.37832614484517124, 0.10003204928940568], [0.9602567843749067, 0.0724344474657973], [0.019300606451071012, 0.9795732518644896], [0.14847808772497184, 0.25870232207150123], [0.21552881156454484, 0.5799123983985056]]])
        np.testing.assert_allclose(tform(a), b)

        a = np.array([[[0.9757516851399299, 0.27300890129390465, 0.9700750738510008, 0.02549734896729483, 0.8880437054177104], [0.7086088382481099, 0.2777736736315105, 0.8948631921780887, 0.026522552598975735, 0.6256366173439284], [0.32954271081208253, 0.967121130692352, 0.16857640481509484, 0.9014829863134214, 0.32993565087121357], [0.8892333217310002, 0.5124516587590872, 0.51062890693618, 0.38682715356733255, 0.530088935959223], [0.9447074808964758, 0.8928622469672834, 0.6771143998332181, 0.6390273844915813, 0.548361337775251]], [[0.27268311786411736, 0.1482686421476278, 0.8563029768335465, 0.6350567989821495, 0.2996434942475267], [0.4602197063913872, 0.02452739723427, 0.558065100924011, 0.3611515171043168, 0.5027095407690281], [0.15362753737206158, 0.4255076374308092, 0.9061718405949403, 0.008511590056627494, 0.9688640997540201], [0.6908937254227938, 0.09941639436140837, 0.28977587592057885, 0.5390735467669154, 0.7241478484039084], [0.3888674304090679, 0.2270839709579695, 0.45485987961584495, 0.9720825075264246, 0.8338182342258864]], [[0.9147906602686022, 0.667284844044465, 0.44066609303413806, 0.6850919910505949, 0.6485983083692556], [0.02910001420110575, 0.919531435498915, 0.5424570027145418, 0.9911416509743957, 0.38310289154914323], [0.8066693253136108, 0.46100682934939485, 0.8268242136411484, 0.5391182349867721, 0.8872648394626437], [0.8801068635197443, 0.32830330828921095, 0.40442494288519115, 0.5446473574026356, 0.6216928996348438], [0.3793560782249866, 0.5421294535799384, 0.12091936113913404, 0.6806972386680347, 0.28711926168416746]]])
        b = np.array([[[0.9447074808964758, 0.8928622469672834, 0.6771143998332181, 0.6390273844915813, 0.548361337775251], [0.8892333217310002, 0.5124516587590872, 0.51062890693618, 0.38682715356733255, 0.530088935959223], [0.32954271081208253, 0.967121130692352, 0.16857640481509484, 0.9014829863134214, 0.32993565087121357], [0.7086088382481099, 0.2777736736315105, 0.8948631921780887, 0.026522552598975735, 0.6256366173439284], [0.9757516851399299, 0.27300890129390465, 0.9700750738510008, 0.02549734896729483, 0.8880437054177104]], [[0.3888674304090679, 0.2270839709579695, 0.45485987961584495, 0.9720825075264246, 0.8338182342258864], [0.6908937254227938, 0.09941639436140837, 0.28977587592057885, 0.5390735467669154, 0.7241478484039084], [0.15362753737206158, 0.4255076374308092, 0.9061718405949403, 0.008511590056627494, 0.9688640997540201], [0.4602197063913872, 0.02452739723427, 0.558065100924011, 0.3611515171043168, 0.5027095407690281], [0.27268311786411736, 0.1482686421476278, 0.8563029768335465, 0.6350567989821495, 0.2996434942475267]], [[0.3793560782249866, 0.5421294535799384, 0.12091936113913404, 0.6806972386680347, 0.28711926168416746], [0.8801068635197443, 0.32830330828921095, 0.40442494288519115, 0.5446473574026356, 0.6216928996348438], [0.8066693253136108, 0.46100682934939485, 0.8268242136411484, 0.5391182349867721, 0.8872648394626437], [0.02910001420110575, 0.919531435498915, 0.5424570027145418, 0.9911416509743957, 0.38310289154914323], [0.9147906602686022, 0.667284844044465, 0.44066609303413806, 0.6850919910505949, 0.6485983083692556]]])
        np.testing.assert_allclose(tform(a), b)

if "__main__" == __name__:
    unittest.main()